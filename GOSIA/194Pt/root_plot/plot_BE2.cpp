#include <TROOT.h>
#include <iostream>
#include <vector>
#include <cstdio>
#include <stdio.h>

void plot_BE2()
{
    TCanvas *c2 = new TCanvas("c2","B(E2)",900,900);
    
	double this_work[21]={1.28673,0.11196,0.52265,2.37662,2.00595,0.30347,0.97503,2.62963,0.04292,2.10106,0.19158,0.25873,2.98533,0.10201,1.05869,-0.40358,2.28334,0.04191,1.83407,0.03269,0.0033};
	double index[21]={4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84};
	double this_work_err_high[21]={0.00942,0.00322,0.07454,0.07464,0.04671,0.00902,0.14294,0.05979,0.46236,0.24589,0.02865,0.21217,0.45616,0.34346,0.19696,0.09303,0.11997,0.12031,0.15091,0.00603,0.25194};
double this_work_err_low[21]={0.00923,0.00224,0.06842,0.04814,0.04585,0.00969,0.12538,0.06577,0.66748,0.06732,0.37483,0.19277,1.05682,0.31433,3.03194,0.08761,0.04903,0.20879,0.23411,0.00349,0.4877};
    TGraphAsymmErrors *this_work_be2 =  new TGraphAsymmErrors(21,index,this_work,0,0,this_work_err_low,this_work_err_high);
    this_work_be2->SetMarkerStyle(3);
    this_work_be2->SetLineColor(2);
    this_work_be2->SetMarkerColor(2);
    this_work_be2->SetMarkerStyle(3);
    this_work_be2->SetLineColor(1);
    this_work_be2->SetMarkerColor(1);
    this_work_be2->SetTitle("");
    this_work_be2->GetXaxis()->SetTitle("Transition");
    this_work_be2->GetXaxis()->CenterTitle();
    this_work_be2->GetXaxis()->SetTitleSize(0.05);
    this_work_be2->GetXaxis()->SetTitleOffset(1.85);
    this_work_be2->GetXaxis()->CenterTitle();
    this_work_be2->GetYaxis()->SetTitle("E2 matrix element");
    this_work_be2->GetYaxis()->CenterTitle();
    this_work_be2->GetYaxis()->SetTitleSize(0.05);
    this_work_be2->GetYaxis()->SetTitleOffset(0.9);
   	this_work_be2->GetXaxis()->SetLabelSize(0);
    this_work_be2->Draw("AP");
    
    TLatex *t0 = new TLatex(4.05,-3.08,"2^{+}_{1} #rightarrow 0^{+}_{1}");
    t0->SetTextAlign(22);
    t0->SetTextFont(43);
    t0->SetTextSize(24);
    t0->SetTextAngle(90);
    t0->Draw();
        TLatex *t1 = new TLatex(8.05,-3.08,"2^{+}_{2} #rightarrow 0^{+}_{1}");
    t1->SetTextAlign(22);
    t1->SetTextFont(43);
    t1->SetTextSize(24);
    t1->SetTextAngle(90);
    t1->Draw();
        TLatex *t2 = new TLatex(12.05,-3.08,"2^{+}_{1} #rightarrow 2^{+}_{1}");
    t2->SetTextAlign(22);
    t2->SetTextFont(43);
    t2->SetTextSize(24);
    t2->SetTextAngle(90);
    t2->Draw();
        TLatex *t3 = new TLatex(16.05,-3.08,"2^{+}_{1} #rightarrow 4^{+}_{1}");
    t3->SetTextAlign(22);
    t3->SetTextFont(43);
    t3->SetTextSize(24);
    t3->SetTextAngle(90);
    t3->Draw();
        TLatex *t4 = new TLatex(20.05,-3.08,"2^{+}_{1} #rightarrow 2^{+}_{2}");
    t4->SetTextAlign(22);
    t4->SetTextFont(43);
    t4->SetTextSize(24);
    t4->SetTextAngle(90);
    t4->Draw();
        TLatex *t5 = new TLatex(24.05,-3.08,"2^{+}_{1} #rightarrow 4^{+}_{2}");
    t5->SetTextAlign(22);
    t5->SetTextFont(43);
    t5->SetTextSize(24);
    t5->SetTextAngle(90);
    t5->Draw();
        TLatex *t6 = new TLatex(28.05,-3.08,"4^{+}_{1} #rightarrow 4^{+}_{1}");
    t6->SetTextAlign(22);
    t6->SetTextFont(43);
    t6->SetTextSize(24);
    t6->SetTextAngle(90);
    t6->Draw();
        TLatex *t7 = new TLatex(32.05,-3.08,"4^{+}_{1} #rightarrow 6^{+}_{1}");
    t7->SetTextAlign(22);
    t7->SetTextFont(43);
    t7->SetTextSize(24);
    t7->SetTextAngle(90);
    t7->Draw();
        TLatex *t8 = new TLatex(36.05,-3.08,"4^{+}_{1} #rightarrow 2^{+}_{2}");
    t8->SetTextAlign(22);
    t8->SetTextFont(43);
    t8->SetTextSize(24);
    t8->SetTextAngle(90);
    t8->Draw();
        TLatex *t9 = new TLatex(40.05,-3.08,"4^{+}_{1} #rightarrow 4^{+}_{2}");
    t9->SetTextAlign(22);
    t9->SetTextFont(43);
    t9->SetTextSize(24);
    t9->SetTextAngle(90);
    t9->Draw();
        TLatex *t10 = new TLatex(44.05,-3.08,"4^{+}_{1} #rightarrow 6^{+}_{2}");
    t10->SetTextAlign(22);
    t10->SetTextFont(43);
    t10->SetTextSize(24);
    t10->SetTextAngle(90);
    t10->Draw();
        TLatex *t11 = new TLatex(48.05,-3.08,"6^{+}_{1} #rightarrow 6^{+}_{1}");
    t11->SetTextAlign(22);
    t11->SetTextFont(43);
    t11->SetTextSize(24);
    t11->SetTextAngle(90);
    t11->Draw();
        TLatex *t12 = new TLatex(52.05,-3.08,"6^{+}_{1} #rightarrow 8^{+}_{1}");
    t12->SetTextAlign(22);
    t12->SetTextFont(43);
    t12->SetTextSize(24);
    t12->SetTextAngle(90);
    t12->Draw();
        TLatex *t13 = new TLatex(56.05,-3.08,"6^{+}_{1} #rightarrow 4^{+}_{2}");
    t13->SetTextAlign(22);
    t13->SetTextFont(43);
    t13->SetTextSize(24);
    t13->SetTextAngle(90);
    t13->Draw();
        TLatex *t14 = new TLatex(60.05,-3.08,"6^{+}_{1} #rightarrow 6^{+}_{2}");
    t14->SetTextAlign(22);
    t14->SetTextFont(43);
    t14->SetTextSize(24);
    t14->SetTextAngle(90);
    t14->Draw();
        TLatex *t15 = new TLatex(64.05,-3.08,"2^{+}_{2} #rightarrow 2^{+}_{2}");
    t15->SetTextAlign(22);
    t15->SetTextFont(43);
    t15->SetTextSize(24);
    t15->SetTextAngle(90);
    t15->Draw();
        TLatex *t16 = new TLatex(68.05,-3.08,"2^{+}_{2} #rightarrow 4^{+}_{2}");
    t16->SetTextAlign(22);
    t16->SetTextFont(43);
    t16->SetTextSize(24);
    t16->SetTextAngle(90);
    t16->Draw();
        TLatex *t17 = new TLatex(72.05,-3.08,"4^{+}_{2} #rightarrow 4^{+}_{2}");
    t17->SetTextAlign(22);
    t17->SetTextFont(43);
    t17->SetTextSize(24);
    t17->SetTextAngle(90);
    t17->Draw();
        TLatex *t18 = new TLatex(76.05,-3.08,"4^{+}_{2} #rightarrow 6^{+}_{2}");
    t18->SetTextAlign(22);
    t18->SetTextFont(43);
    t18->SetTextSize(24);
    t18->SetTextAngle(90);
    t18->Draw();
        TLatex *t19 = new TLatex(80.05,-3.08,"2^{+}_{1} #rightarrow 2^{+}_{2}");
    t19->SetTextAlign(22);
    t19->SetTextFont(43);
    t19->SetTextSize(24);
    t19->SetTextAngle(90);
    t19->Draw();
        TLatex *t20 = new TLatex(84.05,-3.08,"4^{+}_{1} #rightarrow 4^{+}_{4}");
    t20->SetTextAlign(22);
    t20->SetTextFont(43);
    t20->SetTextSize(24);
    t20->SetTextAngle(90);
    t20->Draw();
    
    double Wu[21]={1.208,0.0888,0.54,1.935,1.517,0.22,1,2.9,0.25,1.51,0.224,0.28,3.08,0.16,1.14,-0.4,1.784,-0.07,2.09,0.028,0.19};
	double Wu_err_high[21]={0.049,0.0012,0.08,0.021,0.011,0.009,0.012,0.1,0.14,0.06,0.017,0.12,0.1,0.06,0.11,0.12,0.045,0.14,0.11,0.013,0.03};
double Wu_err_low[21]={0.017,0.0012,0.06,0.013,0.018,0.009,0.014,0.04,0.06,0.05,0.019,0.27,0.16,0.16,0.24,0.05,0.029,0.14,0.07,0.005,0.06};
    TGraphAsymmErrors *Wu_be2 =  new TGraphAsymmErrors(21,index,Wu,0,0,Wu_err_low,Wu_err_high);
    Wu_be2->SetMarkerStyle(5);
    Wu_be2->SetLineColor(4);
    Wu_be2->SetMarkerColor(4);
    Wu_be2->Draw("P same");
    
    double other[25]={1.37,1.245,1.273,0.09,0.084,0.82,0.59,0.63,2.26,2.06,2.01,1.7,1.455,0.3,0.6,2.04,2.5,2.8,2.47,-0.66,1.59,1.27,2.5,1.91,0.026};
	
	double other_err[25]={0.03,0.04,0.006,0.002,0.006,0.21,0.1,0.18,0.06,0.07,0.05,0.1,0.025,0.07,0.12,0.24,0.36,0.7,0.38,0.6,0.34,0.2,0.7,0.2,0.005};
	double other_index[25]={4,4,4,8,8,12,12,12,16,16,16,20,20,24,28,32,32,40,52,64,68,68,68,76,80};
    TGraphErrors *other_be2 =  new TGraphErrors(25,other_index,other,0,other_err);
    other_be2->SetMarkerStyle(7);
    other_be2->SetLineColor(2);
    other_be2->SetMarkerColor(2);
    other_be2->Draw("P same");
    
   auto legend = new TLegend(0.1,0.7,0.48,0.9);
   legend->AddEntry(Wu_be2,"C.Y. Wu","lep");
   legend->AddEntry(other_be2,"other","lep");
   legend->AddEntry(this_work_be2,"present work","lep");
   legend->Draw();
}

